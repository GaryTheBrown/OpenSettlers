/*******************************************************************************
 * Open Settlers - A Game Engine to run the Settlers 1-4
 * Copyright (C) 2016   Gary The Brown
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; ONLY version 2
 * of the License.
 *******************************************************************************/

#ifndef EXTRACTOR_SETTLERS2_BOBDATATYPE_H
#define EXTRACTOR_SETTLERS2_BOBDATATYPE_H
#include <string>

#include "../../Functions/File/DataReader.h"
#include "../../Functions/File/Functions.h"
#include "../../Functions/Image/FileImage.h"
#include "../../Functions/Image/RGBA.h"
#include "../../Functions/Image/PaletteImage.h"
#include "../../Functions/Image/ConvertPALtoRGB.h"
#include "LST/PlayerColouredBitmap.h"

#include "../../Log.h"

namespace Extractor{
	namespace Settlers2{
		class BOBDataType{
		private:

			struct Header{
				unsigned char height = 0;
				unsigned char ny = 0;
				unsigned int *starts = NULL;
				bool used = false;
			};

			struct DataPart{
				unsigned short size;
				unsigned int offset;
			} part[6];


			PlayerColouredBitmap* imageGroup1[96];
			struct LinkPart{
				unsigned short link;
				PlayerColouredBitmap* image = NULL;
			} *imageGroup2;
			//LinkPart* imageGroup2 = NULL;

			unsigned short goodCount = 0;
            unsigned short itemCount = 0;

			RGBA Palette[256] = {{0,0,0,0},{255,255,0,255},{255,219,23,255},{255,191,51,255},{251,159,75,255},{219,127,43,255},{187,99,19,255},{159,75,0,255},{87,51,39,255},{103,67,55,255},{123,87,71,255},{143,111,91,255},{163,135,115,255},{183,159,139,255},{203,183,167,255},{223,211,199,255},{255,191,179,255},{231,159,143,255},{211,131,115,255},{191,103,91,255},{171,79,67,255},{151,59,47,255},{131,39,31,255},{111,27,15,255},{91,15,7,255},{55,7,0,255},{91,47,19,255},{115,71,35,255},{139,99,55,255},{167,131,83,255},{191,163,115,255},{219,199,151,255},{99,87,75,255},{115,103,87,255},{135,123,107,255},{159,147,131,255},{179,167,151,255},{199,191,175,255},{219,211,199,255},{243,235,223,255},{0,63,23,255},{7,87,23,255},{15,111,19,255},{39,135,27,255},{75,159,43,255},{115,183,63,255},{155,207,87,255},{203,235,115,255},{91,27,19,255},{111,47,31,255},{135,71,51,255},{159,99,71,255},{183,131,99,255},{207,163,127,255},{231,195,159,255},{255,231,199,255},{147,27,27,255},{195,35,35,255},{223,99,99,255},{255,179,179,255},{0,27,123,255},{19,59,167,255},{51,103,211,255},{95,159,255,255},{123,59,19,255},{135,71,23,255},{147,87,31,255},{159,103,39,255},{171,119,47,255},{183,139,55,255},{195,159,67,255},{207,175,75,255},{219,195,87,255},{231,215,99,255},{243,235,111,255},{255,255,127,255},{179,167,143,255},{163,151,131,255},{147,139,123,255},{131,127,111,255},{83,55,39,255},{103,71,55,255},{115,79,63,255},{127,91,71,255},{135,103,79,255},{147,111,91,255},{159,123,99,255},{167,135,111,255},{179,147,123,255},{191,159,135,255},{199,171,147,255},{211,183,159,255},{223,199,175,255},{231,211,187,255},{243,223,203,255},{255,239,219,255},{35,39,35,255},{55,63,55,255},{79,87,79,255},{107,111,107,255},{131,139,131,255},{159,163,159,255},{183,187,183,255},{211,215,211,255},{75,27,67,255},{99,39,95,255},{123,55,123,255},{143,71,151,255},{159,95,175,255},{175,115,203,255},{191,139,227,255},{211,167,255,255},{51,51,59,255},{63,63,71,255},{71,75,83,255},{83,87,95,255},{95,99,111,255},{107,111,123,255},{119,127,135,255},{135,139,147,255},{147,155,163,255},{159,167,175,255},{171,179,187,255},{183,195,203,255},{199,207,215,255},{211,223,227,255},{223,235,239,255},{239,251,255,255},{0,211,247,255},{0,123,219,255},{0,55,191,255},{0,0,167,255},{255,255,0,255},{203,203,0,255},{151,151,0,255},{103,103,0,255},{255,0,0,255},{215,0,0,255},{175,0,0,255},{135,0,0,255},{187,151,231,255},{155,119,191,255},{123,91,155,255},{95,67,119,255},{119,119,119,255},{79,79,79,255},{39,39,39,255},{0,0,0,255},{99,247,175,255},{67,195,115,255},{43,143,63,255},{23,95,27,255},{255,187,71,255},{223,147,39,255},{195,107,15,255},{167,75,0,255},{255,251,243,255},{183,175,163,255},{115,103,95,255},{47,39,35,255},{0,27,35,255},{7,47,35,255},{15,59,27,255},{35,71,27,255},{71,83,47,255},{95,91,67,255},{103,99,75,255},{115,111,87,255},{123,123,95,255},{135,135,107,255},{143,147,119,255},{155,155,127,255},{163,167,139,255},{175,175,151,255},{183,187,167,255},{195,199,179,255},{0,47,123,255},{0,55,131,255},{0,63,139,255},{0,71,147,255},{0,83,155,255},{0,91,163,255},{0,103,171,255},{0,115,179,255},{0,127,187,255},{0,143,195,255},{0,155,203,255},{0,171,211,255},{31,183,215,255},{63,199,219,255},{99,211,223,255},{139,223,231,255},{143,115,91,255},{147,119,95,255},{155,127,99,255},{163,131,103,255},{171,139,107,255},{179,143,115,255},{187,151,119,255},{195,159,127,255},{199,171,135,255},{207,179,147,255},{215,191,155,255},{223,203,167,255},{231,211,175,255},{239,223,187,255},{247,231,199,255},{255,243,211,255},{55,39,11,255},{67,47,15,255},{79,59,23,255},{91,67,31,255},{107,79,39,255},{119,91,51,255},{131,103,63,255},{143,115,75,255},{159,131,91,255},{171,143,107,255},{183,159,123,255},{199,171,143,255},{211,187,163,255},{223,203,183,255},{235,219,203,255},{251,239,227,255},{19,51,0,255},{23,59,0,255},{31,71,0,255},{39,79,0,255},{47,91,7,255},{55,103,7,255},{67,115,11,255},{75,123,15,255},{91,135,19,255},{103,147,23,255},{115,159,31,255},{127,167,35,255},{139,179,43,255},{151,191,51,255},{167,203,59,255},{183,219,75,255},{0,99,135,255},{0,99,135,255},{0,103,135,255},{0,107,135,255},{0,107,135,255},{0,111,135,255},{0,115,135,255},{0,107,135,255},{167,59,11,255},{191,103,7,255},{215,159,0,255},{191,103,7,255},{0,0,0,255},{255,255,255,255},{255,0,143,255},{255,255,255,255}};
		public:
			explicit BOBDataType(std::string file);
			~BOBDataType();

			void SaveToFile(std::string location);
		};
	}
}

#endif